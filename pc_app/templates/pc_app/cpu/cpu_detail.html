{% extends 'pc_app/base.html' %}
{% block title %}{{ cpu.name }}{% endblock %}
{% block content %}
{% load custom_filters %}

<h1>CPU Details</h1>
<p>CPU: {{ cpu.name }}</p>
<p>Cores: {{ cpu.core_count }}</p>
<p>Core Clock: {{ cpu.core_clock }}</p>
<p>Boost Clock: {{ cpu.boost_clock }}</p>
<p>Integrated_Graphics: {{ cpu.graphics }}</p>
<p>TDP: {{ cpu.tdp }}</p>
<p>Multithreading: {% if cpu.smt %}Yes{% else %}No{% endif %}</p>
<p>Price: {{ cpu.price|convert_to_myr }}</p>

<button class="select-button" onclick="selectComponent('cpu', '{{ cpu.id }}')">Add</button>

<h2>Add Rating for CPU {{cpu.id}}</h2>

<!-- <input type="hidden" name="rating" id="cpu_ratingInput" value="{{ rating_form.cpuRating.value }}" /> -->


{% if rate %}
  Your previous rating: 

  <div class="star-rating">
    <span class="fa fa-star {% if rate >= 1 %}checked{% endif %}"></span>
    <span class="fa fa-star {% if rate >= 2 %}checked{% endif %}"></span>
    <span class="fa fa-star {% if rate >= 3 %}checked{% endif %}"></span>
    <span class="fa fa-star {% if rate >= 4 %}checked{% endif %}"></span>
    <span class="fa fa-star {% if rate >= 5 %}checked{% endif %}"></span>
  </div>

{% endif %}
<form method="post" name="cpu_rating_form">
  {% csrf_token %}
  <select type="hidden" name="cpuRating" id="cpu_ratingInput" style="display: none;">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
  </select>

  <div id="star-rating">
    <ul class="btn btn-light list-inline rating-list">
      <li onclick="updateRating(5)" data-order-rating="5"><i class="fa fa-star" id="star-5" title="Rate 5"></i></li>
      <li onclick="updateRating(4)" data-order-rating="4"><i class="fa fa-star" id="star-4" title="Rate 4"></i></li>
      <li onclick="updateRating(3)" data-order-rating="3"><i class="fa fa-star" id="star-3" title="Rate 3"></i></li>
      <li onclick="updateRating(2)" data-order-rating="2"><i class="fa fa-star" id="star-2" title="Rate 2"></i></li>
      <li onclick="updateRating(1)" data-order-rating="1"><i class="fa fa-star" id="star-1" title="Rate 1"></i></li>
    </ul>
  </div>

  <button type="submit" name="cpu_rating_form">Rate</button>
</form>

<h2>Select another CPU for comparison:</h2>
<button id="chooseButton">Choose</button>

<div id="cpuList" style="display: none;">
  <h3>List of CPUs for Comparison:</h3>
  <ul>
    {% for other_cpu in other_cpus %}
    <li>
      <a href="{% url 'cpu_comparison' cpu.pk other_cpu.pk %}">{{ other_cpu.name }}</a>
    </li>
    {% endfor %}
  </ul>
</div>

<script>
  document.getElementById('chooseButton').addEventListener('click', function () {
    var cpuList = document.getElementById('cpuList');
    cpuList.style.display = (cpuList.style.display === 'none') ? 'block' : 'none';
  });

  // Function to update the star rating
  function updateRating(rating) {
    const starElements = document.querySelectorAll('.fa-star');

    // Remove 'checked' class from all stars
    starElements.forEach(star => {
      star.classList.remove('checked');
    });

    // Add 'checked' class to stars up to the selected rating
    for (let i = 1; i <= rating; i++) {
      document.getElementById('star-' + i).classList.add('checked');
    }

    // Set the selected rating in the dropdown
    document.getElementById('cpu_ratingInput').value = rating;
  }
</script>

{% endblock %}