{% extends 'pc_app/base.html' %}
{% block title %}{{ cpu.name }}{% endblock %}
{% block content %}
{% load custom_filters %}
{% load static %}

<!-- <input type="hidden" name="rating" id="cpu_ratingInput" value="{{ rating_form.cpuRating.value }}" /> -->
<link rel="stylesheet" type="text/css" href="{% static 'css/component.css' %}">

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CPU Specifications</title>
</head>

<body>
  <header>
    <h3>CPU #{{cpu.name}} Specifications</h3>
  </header>

  <main>
    <div class="component-container">
      <section class="component-metadata">
        {% if rate %}
        <div class="star-rating">
          Previously Rated:
          <span class="fa fa-star {% if rate >= 1 %}checked{% endif %}"></span>
          <span class="fa fa-star {% if rate >= 2 %}checked{% endif %}"></span>
          <span class="fa fa-star {% if rate >= 3 %}checked{% endif %}"></span>
          <span class="fa fa-star {% if rate >= 4 %}checked{% endif %}"></span>
          <span class="fa fa-star {% if rate >= 5 %}checked{% endif %}"></span>
        </div>
        {% endif %}
        <br>
        <table>
          <thead>
            <tr>
              <th>Model <span class="icon" data-hover-text="The name or model of the Central processing unit (CPU)"
                  title="Hover for More Info">&#9432;</span></th>
              <th>{{ cpu.name }}</th>
            </tr>
          </thead>
          <tr>
            <td>Cores <span class="icon" data-hover-text="The number of processing cores"
                title="Hover for More Info">&#9432;</span></td>
            <td>{{ cpu.core_count }}</td>
          </tr>
          <tr>
            <td>Base Clock <span class="icon" data-hover-text="The base clock speed of the processing cores"
                title="Hover for More Info">&#9432;</span></td>
            <td>{{ cpu.core_clock }} GHz</td>
          </tr>
          <tr>
            <td>Max Turbo Clock <span class="icon"
                data-hover-text="The maximum clock speed the cores can reach under load"
                title="Hover for More Info">&#9432;</span></td>
            <td>{{ cpu.boost_clock }} GHz</td>
          </tr>
          <tr>
            <td>Integrated Graphics <span class="icon"
                data-hover-text="Information about the integrated graphics processing unit (GPU)"
                title="Hover for More Info">&#9432;</span></td>
            <td>{{ cpu.graphics }}</td>
          </tr>
          <tr>
            <td>Thermal Design Power <span class="icon"
                data-hover-text="The maximum amount of power the cpu is designed to consume and dissipate as heat"
                title="Hover for More Info">&#9432;</span></td>
            <td>{{ cpu.tdp }}</td>
          </tr>
          <tr>
            <td>Multithreading <span class="icon"
                data-hover-text="Indicates whether the cpu supports simultaneous multithreading, which can improve multitasking and performance"
                title="Hover for More Info">&#9432;</span></td>
            <td>{% if cpu.smt %}Yes{% else %}No{% endif %}</td>
          </tr>
          <tr>
            <td>Socket <span class="icon"
                data-hover-text="The type of CPU socket or interface used for connecting the cpu to the motherboard"
                title="Hover for More Info">&#9432;</span></td>
            <td>{{ cpu.socket }}</td>
          </tr>
          <tr>
            <td>Price</td>
            <td>$ {{ cpu.price|convert_to_myr }}</td>
          </tr>
          <!-- Add more CPU details as needed -->
        </table>

        <br>


        <div class="rating">
          {% if cart_item %}
          <!-- {% if messages %}
          <ul class="messages">
            {% for message in messages %}
            <li {% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
            {% endfor %}
          </ul>
          {% endif %} -->


          <form method="post" name="cpu_rating_form">
            {% csrf_token %}
            <select type="hidden" name="cpuRating" id="cpu_ratingInput" style="display: none;">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>

            <div id="star-rating">
              Rate CPU:<br>
              <ul class="btn btn-light list-inline rating-list">
                <li onclick="updateRating(5)" data-order-rating="5"><i class="fa fa-star" id="star-5"
                    title="Rate 5"></i>
                </li>
                <li onclick="updateRating(4)" data-order-rating="4"><i class="fa fa-star" id="star-4"
                    title="Rate 4"></i>
                </li>
                <li onclick="updateRating(3)" data-order-rating="3"><i class="fa fa-star" id="star-3"
                    title="Rate 3"></i>
                </li>
                <li onclick="updateRating(2)" data-order-rating="2"><i class="fa fa-star" id="star-2"
                    title="Rate 2"></i>
                </li>
                <li onclick="updateRating(1)" data-order-rating="1"><i class="fa fa-star" id="star-1"
                    title="Rate 1"></i>
                </li>
              </ul>
            </div>

            <button type="submit" id="rate-button" name="cpu_rating_form">Rate</button>
            
          </form>
          <button class="select-button" onclick="selectComponent('cpu', '{{ cpu.id }}')"><span class="fas fa-cog"></span> Select CPU</button>
          
          {% else %}
          <button class="select-button1" onclick="selectComponent('cpu', '{{ cpu.id }}')"><span class="fas fa-cog"></span> Select CPU</button>
          {% endif %}
        </div>
      </section>

      <section class="component-comparison">
        <button id="chooseButton" class="compare-button">Select CPU to Compare</button>
        <div id="cpuList" class="component-list">
          <input type="text" id="cpuSearch" class="search-input" placeholder="Search CPUs">
          <div class="scrollable-list-container">
          <ul class="component-items">
            {% for other_cpu in other_cpus %}
            <li class="component-item">
              <div class="divider"></div>
              <a href="{% url 'cpu_comparison' cpu.pk other_cpu.pk %}" class="component-link">{{ other_cpu.name }}</a>
            </li>
            {% endfor %}
          </ul>
        </div>
      </div>
      </section>

    </div>

  </main>
</body>



<script>
  // JavaScript for search functionality
  const cpuSearch = document.getElementById('cpuSearch');
  const cpuItems = document.querySelectorAll('#cpuList ul li');

  cpuSearch.addEventListener('input', () => {
    const searchValue = cpuSearch.value.toLowerCase();
    cpuItems.forEach(cpuItem => {
      const cpuName = cpuItem.textContent.toLowerCase();
      if (cpuName.includes(searchValue)) {
        cpuItem.style.display = 'list-item';
      } else {
        cpuItem.style.display = 'none';
      }
    });
  });

  document.getElementById('chooseButton').addEventListener('click', function () {
    const cpuList = document.querySelector('#cpuList'); // Use querySelector to select the first element with id 'cpuList'
    cpuList.style.display = (cpuList.style.display === 'none' || cpuList.style.display === '') ? 'block' : 'none';
  });


  // Function to update the star rating
  function updateRating(rating) {
    const starElements = document.querySelectorAll('.fa-star');

    // Remove 'checked' class from all stars
    starElements.forEach(star => {
      star.classList.remove('checked');
    });

    // Add 'checked' class to stars up to the selected rating
    for (let i = 1; i <= rating; i++) {
      document.getElementById('star-' + i).classList.add('checked');
    }

    // Set the selected rating in the dropdown
    document.getElementById('cpu_ratingInput').value = rating;
  }
</script>


</html>

<style>
  .messages {
    padding: 10px;
    margin: 0;
    font-size: 14px;
  }

  /* Style each individual message item */
  .messages li {
    padding: 5px;
  }

  /* Style the different message tags (e.g., success, error) */
  .messages .success {
    border-radius: 3px;
    background-color: #4CAF50;
    color: white;
  }

  .messages .error {
    border-radius: 5px;
    background-color: #F44336;
    color: white;
  }

  .icon {
    display: inline-block;
    position: relative;
  }

  .icon:hover::before {
    content: attr(data-hover-text);
    position: absolute;
    background: #333;
    color: #fff;
    padding: 5px;
    border-radius: 5px;
    transform: translateX(-50%);
    opacity: 0;
    visibility: visible;
    transition: opacity 0.3s, visibility 0.3s;
    font-size: 12px;
  }

  .icon:hover::before {
    left: 20px;
    opacity: 1;
    display: inline-block;
    visibility: visible;
  }

  /*  */

  .component-comparison {
    background-color: #f0f0f0;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 5px;
    text-align: center;
    margin: 20px;
    max-width: 450px;
  }

  .component-list {
    display: none;
    margin-top: 20px;
  }

  .search-input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }

  .component-items {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }

  .component-item {
    margin: 10px 0;
  }

  .component-link {
    text-decoration: none;
    color: #333;
    font-weight: bold;
  }

  .component-link:hover {
    text-decoration: underline;
    color: #007bff;
  }

  form {
    display: inline-block;
    /* Display the form and button inline */
  }

  .select-button {
    vertical-align: bottom;
    /* Align the button with the top of the form button */
    float: right;
    /* Place it at the right of the container */
    margin-top: 76px;
    /* Add some spacing between the buttons */
  }

  
  .select-button1 {
    vertical-align: bottom;
    float: right;
  }


  .component-container {
    display: flex;
    flex-direction: row;
    /* Horizontal layout for section1 and section2 */
    flex-wrap: wrap;
    padding: 20px;
  }



  .component-metadata {
    border: 1px solid #ccc;
    border-radius: 5px;
  }

  /* main {
    width: 80%;
    margin: 0 auto;
    padding: 20px;
  } */

  .component-metadata,
  .component-comparison {
    float: left;
    width: 50%;
    padding: 10px;
    /* Adjust the width as needed */
  }

  .component-metadata h2 {
    color: #333;
  }

  .rating {
    margin-top: 10px;
    display: flexbox
  }

  .stars {
    font-size: 24px;
    cursor: pointer;
  }

  .stars .star {
    display: inline-block;
    margin-right: 5px;
    color: #f0c419;
    /* Yellow color for stars */
  }

  .component-comparison h2 {
    color: #333;
  }

  label,
  select {
    display: block;
    margin-bottom: 10px;
  }

  button {
    background-color: #333;
    color: #fff;
    border: none;
    cursor: pointer;
    padding: 10px 20px;
    border-radius: 5px;
    font-weight: bold;
  }

  button:hover {
    background-color: #555;
  }
</style>
{% endblock %}